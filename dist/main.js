!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const r=bigInt(2).pow(2048).minus(1942289),o=(e,t)=>{return e.modPow(t,r)},i=(e,t,n,i)=>{const c=t.modPow(i,r);return[n.times(c).mod(r),o(e,i)]},c=(e,t,n)=>{const o=r.minus(e).minus(1),i=t.modPow(o,r);return n.times(i).mod(r)},u=r.minus(1),d=(e,t)=>{return e.modPow(t,r)},s=(e,t,n,o)=>{const i=e.modPow(o,r),c=n.times(i).mod(u),d=u.minus(c),s=o.modInv(u);return[i,t.plus(d).times(s).mod(u)]},l=(e,t,n,o,i)=>{const c=e.modPow(t,r),u=n.modPow(o,r),d=o.modPow(i,r),s=u.times(d).mod(r);return c.equals(s)};document.querySelectorAll(".tex-expression").forEach(e=>{e.setAttribute("role","presentation"),e.setAttribute("aria-hidden","true");const t=e.innerText;katex.render(t,e,{throwOnError:!1})});const a=()=>bigInt.randBetween(2,r);if("PASS"!==(()=>{const e=a(),t=a(),n=((e,t)=>{return e.modPow(t,r)})(e,t),u=a(),d=o(e,u),s=r.minus(t).minus(1),l=n.modPow(u,r),g=d.modPow(s,r);if(l.times(g).mod(r).notEquals(1))return"FAIL #1";const m=a(),[y,p]=i(e,n,m,u),I=c(t,p,y);return m.notEquals(I)?"FAIL #2":"PASS"})()||"PASS"!==(()=>{let e=a(),t=a(),n=d(e,t),r=a(),o=a().or(1),[i,c]=s(e,r,t,o);const g=t.times(i),m=o.times(c),y=g.plus(m).mod(u);return r.notEquals(y)?"FAIL #1":l(e,r,n,i,c)?"PASS":"FAIL #2"})())throw"Something is wrong with the library!";const g=document.getElementById("cryptography-generator"),m=document.getElementById("cryptography-private-key"),y=document.getElementById("cryptography-button"),p=document.getElementById("cryptography-status"),I=document.getElementById("cryptography-public-key");let v="generator",b="privateKey",f="publicKey";y.onclick=()=>{v="generator",b="privateKey",f="publicKey";try{v=bigInt(g.value),b=bigInt(m.value),f=o(v,b),I.value=f.toString(),p.innerText=""}catch(e){p.innerText=e.toString()}};const E=document.getElementById("encryption-plaintext-integer"),B=document.getElementById("encryption-secret-nonce"),h=document.getElementById("encrypt-button"),x=document.getElementById("encrypt-status"),S=document.getElementById("encryption-ciphertext-integer"),w=document.getElementById("encryption-decryption-ingredient");let T="plainText",P="secretNonce",A="cipherText",k="decryptionIngredient";h.onclick=()=>{T="plainText",P="secretNonce",A="cipherText",k="decryptionIngredient";try{T=bigInt(E.value),P=bigInt(B.value);const[e,t]=i(v,f,T,P);A=e,k=t,S.value=A.toString(),w.value=k.toString(),x.innerText=""}catch(e){x.innerText=e.toString(),S.value="",w.value=""}};const K=document.getElementById("decryption-ciphertext-integer"),O=document.getElementById("decryption-decryption-ingredient"),j=document.getElementById("decrypt-button"),_=document.getElementById("decrypt-status"),q=document.getElementById("decryption-plaintext-integer");let F="plainText",L="cipherText",M="decryptionIngredient";j.onclick=()=>{L="cipherText",M="decryptionIngredient";try{L=bigInt(K.value),M=bigInt(O.value),F=c(b,M,L),q.value=F.toString(),_.innerText=""}catch(e){_.innerText=e.toString(),q.value=""}};const N=document.getElementById("authentication-generator"),R=document.getElementById("authentication-signing-key"),z=document.getElementById("authentication-button"),C=document.getElementById("authentication-status"),D=document.getElementById("authentication-verification-key");let G="generator",H="signingKey",J="verificationKey";z.onclick=()=>{G="generator",H="signingKey",J="verificationKey";try{G=bigInt(N.value),H=bigInt(R.value),J=d(G,H),D.value=J.toString(),C.innerText=""}catch(e){C.innerText=e.toString(),D.value=""}};const Q=document.getElementById("signature-message-integer"),U=document.getElementById("signature-secret-nonce"),V=document.getElementById("signature-button"),W=document.getElementById("signature-status"),X=document.getElementById("signature-witness-r"),Y=document.getElementById("signature-witness-s");let Z="messageInteger",$="secretNonce",ee="witnessR",te="witnessS";V.onclick=()=>{Z="messageInteger",$="secretNonce",ee="witnessR",se="witnessS";try{Z=bigInt(Q.value),$=bigInt(U.value);const[e,t]=s(G,Z,H,$);ee=e,te=t,X.value=ee.toString(),Y.value=te.toString(),W.innerText=""}catch(e){X.value="",Y.value="",W.innerText=e.toString()}};const ne=document.getElementById("verify-message-integer"),re=document.getElementById("verify-witness-r"),oe=document.getElementById("verify-witness-s"),ie=document.getElementById("verify-button"),ce=document.getElementById("verify-status"),ue=document.getElementById("verify-authenticity");let de="messageInteger",se="witnessR",le="witnessS";ie.onclick=()=>{de="messageInteger",se="witnessR",le="witnessS2";try{de=bigInt(ne.value),se=bigInt(re.value),le=bigInt(oe.value),l(G,de,J,se,le)?ue.value="Authentic":ue.value="Forgery",ce.innerText=""}catch(e){ue.value="",ce.innerText=e.toString()}}}]);